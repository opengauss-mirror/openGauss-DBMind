select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1184 and 1184+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1202 and 1202+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1186 and 1186+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1208 and 1208+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1220 and 1220+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1215 and 1215+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1210 and 1210+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1211 and 1211+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1188 and 1188+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
select        sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  	partition by grouping(i_category)+grouping(i_class),  	case when grouping(i_class) = 0 then i_category end   	order by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1222 and 1222+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when grouping(i_category)+grouping(i_class) = 0 then i_category end,    rank_within_parent  limit 100;  
