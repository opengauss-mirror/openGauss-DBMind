with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('khaki','purple','metallic'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('khaki','purple','metallic'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('khaki','purple','metallic'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('aquamarine','white','purple'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('aquamarine','white','purple'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('aquamarine','white','purple'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('metallic','brown','spring'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('metallic','brown','spring'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('metallic','brown','spring'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('indian','firebrick','pink'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('indian','firebrick','pink'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('indian','firebrick','pink'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('coral','honeydew','plum'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('coral','honeydew','plum'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('coral','honeydew','plum'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('orange','rose','peach'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('orange','rose','peach'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('orange','rose','peach'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('sandy','violet','chocolate'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('sandy','violet','chocolate'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('sandy','violet','chocolate'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('purple','sky','lawn'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('purple','sky','lawn'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('purple','sky','lawn'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('saddle','smoke','black'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('saddle','smoke','black'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('saddle','smoke','black'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('plum','beige','rosy'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 4  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('plum','beige','rosy'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 4  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('plum','beige','rosy'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 4  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;  
